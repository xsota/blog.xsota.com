---
layout: post
title:  "Androidアプリ作ってみよう〜じゃんけん編"
date:   2013-07-03 00:00:00 +0900
permalink: /:year/:month/:title.html
categories: 開発
tags:
  - じゃんけん
  - Android
---

<p>ゼミの仲間にAndroidアプリの開発について教えることになったのでじゃんけんアプリを使ってeclipseアプリ作成の流れを記事にしました。<br />口頭で説明することを前提に書いているのでけっこうてきとうです。<br />jdkやらeclipseやらandroidアプリの開発環境が整っていることが前提でお話は進んでいきます。<br />私はJava初心者なのでわかりやすいコードではないと思います...もっとがんばります...<br /><br /><br /></p>

<h2>今回作るアプリ</h2>

<div>Google Play で「じゃんけん！」をチェック！&nbsp;</div>

<div><a href="https://play.google.com/store/apps/details?id=com.xsota.janken">https://play.google.com/store/apps/details?id=com.xsota.janken</a></div>

<p><br /></p>

<h1>何故じゃんけんアプリか</h1>

<ul><li>ButtonとButtonのlistenerを使える</li><li>ついでにプログラムからimage viewの画像の変更の仕方も学べる(やったね！)</li><li>textviewの変更とかもおぼえられる</li><li>用意する絵が簡単</li></ul>

<p><br /><br /><br /></p>

<h1>じゃんけんアプリ開発の流れ</h1>

<p><br />今回は、以下のような流れでじゃんけんアプリを作成します。<br /><br />Androidアプリケーションの新規作成<br />↓<br />グーチョキパーをイメージボタンに設定<br />結果表示のテキストビューを作成<br />自分の出した手と相手の手を表示するイメージビューを作成<br />↓<br />押されたボタンの手が画面に表示されるように<br />↓<br />相手の手をランダムに決定し画面に表示されるように<br />↓<br />自分の手と相手の手を比較し<br />結果(勝ち,負け,あいこ)を表示する<br /><br />では、実際にこの流れに沿ってやってみたいと思います。<br /><a name='more'></a><br /><br /><br /></p>

<h1>0.アンドロイドアプリケーションの新規作成</h1>

<p><br /></p>

<div style="clear: both; text-align: center;"><a href="/assets/img/2013/07/janken1.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="/assets/img/2013/07/janken1.png" /></a></div>

<p>File &gt;New &gt;Android Application Project を選択<br /><br />パッケージ名やアプリケーション名,アイコン画像は任意でいいです。<br />あとはデフォルトのままで問題ないと思います。<br /><br /><br /><br /></p>

<h1>1.イメージボタンを設定する</h1>

<p>初めにイメージボタンに表示するためにグーチョキパーの画像を用意します。<br />gimpとかでてきとうに描いてください。<br /><br />次に res&gt; layout&gt; hogehgoe.xml を開きます。(たぶんアプリケーションを新規作成した時点で勝手に開かれてます)<br /><br />デフォルトで生成されているhello worldのテキストビューを削除します。<br /><br />そしてPaletteの中からImage Buttonを選択しててきとうに配置します。<br />これはじゃんけんの手を選択するボタンなのでグーチョキパーの画像を設定しておきます。<br />じゃんけんの結果を表示するためののテキストビューを作成します。<br />自分の出した手と相手の手を表示するイメージビューを作成します。<br /><br /><br />私はこんな感じにしました。<br /></p>

<div style="clear: both; text-align: center;"><a href="/assets/img/2013/07/janken2.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="/assets/img/2013/07/janken2.png" /></a></div>

<p><br />それぞれのidは以下のようになっています。<br />ぐーのimage buttonのid:gu<br />ちょき:choki<br />ぱー:per<br />結果表示用text viewのid:result<br />自分手の表示するimage viewのid:me<br />相手の手を表示するimage view:enemy<br /><br /><br /></p>

<h1>2.押されたボタンに対応する手を表示</h1>

<p><br />ここからはいよいよプログラムを書いていきます。<br /><br /></p>

{% highlight java %}
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.ImageView;

public class MainActivity extends Activity implements OnClickListener{

 ImageButton gu,choki,per; 
 int hands[] = new int[3];
 ImageView me;
 
 @Override
 protected void onCreate(Bundle savedInstanceState) {
 
  super.onCreate(savedInstanceState);
  
  setContentView(R.layout.activity_main);
  
  hands[0] = R.drawable.gu;
  hands[1] = R.drawable.choki;
  hands[2] = R.drawable.per;
    
  me = (ImageView) findViewById(R.id.me);
  gu = (ImageButton) findViewById(R.id.gu);
  choki = (ImageButton) findViewById(R.id.choki);
  per = (ImageButton) findViewById(R.id.per);
  
  gu.setOnClickListener(this);
  choki.setOnClickListener(this);
  per.setOnClickListener(this);  
 }

 @Override
 public void onClick(View v) {
   
  int hand=0;
  
  //0:gu 1:choki 2:per
  if (v == gu ){
   hand = 0;
  }else if (v == choki ){
   hand = 1;
  }else if (v == per ){
   hand = 2;
  }
  
  me.setImageResource(hands[hand]);
 }
}
{% endhighlight %}

<p><br />これでボタンを押すと自分の手の画像が変わるようになりました。<br /><br /></p>

<h1>3.相手の手をランダムに決定し画面に表示されるようにする</h1>

<p><br />これは乱数を使います。<br /><br /><br /></p>

{% highlight java %}
import java.util.Random; // 追加
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.ImageView;


public class MainActivity extends Activity implements OnClickListener{

 ImageButton gu,choki,per; 
 int hands[] = new int[3];
 ImageView me<span style="color: red;">,enemy</span>;
  
 @Override
 protected void onCreate(Bundle savedInstanceState) {
 
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);
  
  hands[0] = R.drawable.gu;
  hands[1] = R.drawable.choki;
  hands[2] = R.drawable.per;
    
  me = (ImageView) findViewById(R.id.me);
  enemy =(ImageView) findViewById(R.id.enemy); // 追加
  gu = (ImageButton) findViewById(R.id.gu);
  choki = (ImageButton) findViewById(R.id.choki);
  per = (ImageButton) findViewById(R.id.per);
  
  gu.setOnClickListener(this);
  choki.setOnClickListener(this);
  per.setOnClickListener(this);  
 }


 @Override
 public void onClick(View v) {  
  Random random = new Random(); // 追加
  int n = random.nextInt(3);</span>
  int hand=0;
  
  //0:gu 1:choki 2:per
  if (v == gu ){
   hand = 0;
  }else if (v == choki ){
   hand = 1;
  }else if (v == per ){
   hand = 2;
  }
  me.setImageResource(hands[hand]);
  enemy.setImageResource(hands[n]); // 追加
  }
}
{% endhighlight %}

<p>これで相手の画像も変わるようになりました。<br /><br /></p>

<h1>4.勝ち負けの判定と結果の表示</h1>

<p><br />ぐー = 0,&nbsp;ちょき = 1,&nbsp;ぱー = 2&nbsp;なので<br /><br /><i>((自分の手-相手の)+3)%3</i><br /><br />の結果が<br /><br />0ならあいこ<br />1なら負け<br />2なら勝ち<br /><br />となります。<br /><br /><br /><br /></p>

{% highlight java %}
import java.util.Random;
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView; // 追加

public class MainActivity extends Activity implements OnClickListener{
 ImageButton gu,choki,per; 
 int hands[] = new int[3];
 ImageView me,enemy; 
 TextView result; // 追加
 
 @Override
 protected void onCreate(Bundle savedInstanceState) {
 
  super.onCreate(savedInstanceState);
  
  setContentView(R.layout.activity_main);
  
  hands[0] = R.drawable.gu;
  hands[1] = R.drawable.choki;
  hands[2] = R.drawable.per;
    
  me = (ImageView) findViewById(R.id.me);
  enemy =(ImageView) findViewById(R.id.enemy);
  gu = (ImageButton) findViewById(R.id.gu);
  choki = (ImageButton) findViewById(R.id.choki);
  per = (ImageButton) findViewById(R.id.per);
  result = (TextView) findViewById(R.id.result); // 追加
  
  gu.setOnClickListener(this);
  choki.setOnClickListener(this);
  per.setOnClickListener(this);  
 }


 @Override
 public void onClick(View v) {  
  Random random = new Random();
  int n = random.nextInt(3);
  int hand=0;
  
  //0:gu 1:choki 2:per
  if (v == gu ){
   hand = 0;
  }else if (v == choki ){
   hand = 1;
  }else if (v == per ){
   hand = 2;
  }
  
  me.setImageResource(hands[hand]);
  enemy.setImageResource(hands[n]);
  int syouhai = (hand - n) + 3;  // 追加
  
  if (syouhai%3 == 0){
   result.setText("あいこ");   
  }else if(syouhai%3 == 1){
   result.setText("あんたの負けだ");
  }else if(syouhai%3 == 2){
   result.setText("あんたの勝ちだ");
  }</span>
  }
}
{% endhighlight %}


<p><br /><br />これで完成！<br /><a href="/assets/img/2013/07/janken3.png"><img border="0" src="/assets/img/2013/07/janken3.png" /></a><br /><br /><br />追記(2013/09/21)<br /><a href="https://play.google.com/store/apps/details?id=com.emilyanne.janken2" target="_blank">ここ</a>にこの記事を参考にアプリを作ってくれた方が居ました。<br /><br />追記(2013/12/29)<br />またこの記事を参考にアプリをつくってくれた方が居ました。超嬉しい。<br /><a href="https://play.google.com/store/apps/details?id=com.takanomeblog.janken" target="_blank">https://play.google.com/store/apps/details?id=com.takanomeblog.janken</a></p>
